<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">




<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
     <title>Message Channels &mdash; Sponge 5.0.0 dokumentation</title>
    
  <link rel="stylesheet" href="../../_static/basic.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/sponge.css" type="text/css" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.1/css/font-awesome.min.css" rel="stylesheet" type="text/css" />
  <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro|Roboto:400italic,700italic,700,400|Montserrat:400,700" rel="stylesheet" type="text/css" />
  <link rel="stylesheet" href="../../_static/tomorrow.css" type="text/css" />
  <link id="syntax-highlighting-ref" rel="stylesheet" href="../../_static/tomorrow_night.css" type="text/css" />
      
  <script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
      URL_ROOT:    '../../',
      VERSION:     '5.0.0',
      COLLAPSE_INDEX: false,
      FILE_SUFFIX: '.html',
      HAS_SOURCE:  true
    };
  </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/store.min.js"></script>
    <script type="text/javascript" src="../../_static/lights.js"></script>
      <link rel="shortcut icon" href="../../_static/favicon.ico"/>
        <link rel="index" title="Indeks" href="../../genindex.html" />
        <link rel="search" title="Søg" href="../../search.html" />
        <link rel="top" title="Sponge 5.0.0 dokumentation" href="../../index.html" />
        <link rel="up" title="Text" href="index.html" />
        <link rel="next" title="TextTemplates" href="templates.html" />
        <link rel="prev" title="The Pagination Service" href="pagination.html" />
    
  <script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-59476017-2', 'auto');
    ga('send', 'pageview');

  </script>
    
  <link rel="alternate" hreflang="da" href="/master/da/">
  <link rel="alternate" hreflang="de" href="/master/de/">
  <link rel="alternate" hreflang="en-GB" href="/master/en-GB/">
  <link rel="alternate" hreflang="en-PT" href="/master/en-PT/">
  <link rel="alternate" hreflang="en" href="/master/en/">
  <link rel="alternate" hreflang="es-ES" href="/master/es-ES/">
  <link rel="alternate" hreflang="fi" href="/master/fi/">
  <link rel="alternate" hreflang="fr" href="/master/fr/">
  <link rel="alternate" hreflang="it" href="/master/it/">
  <link rel="alternate" hreflang="ja" href="/master/ja/">
  <link rel="alternate" hreflang="ko" href="/master/ko/">
  <link rel="alternate" hreflang="lt" href="/master/lt/">
  <link rel="alternate" hreflang="nb" href="/master/nb/">
  <link rel="alternate" hreflang="nl" href="/master/nl/">
  <link rel="alternate" hreflang="pl" href="/master/pl/">
  <link rel="alternate" hreflang="pt-BR" href="/master/pt-BR/">
  <link rel="alternate" hreflang="pt-PT" href="/master/pt-PT/">
  <link rel="alternate" hreflang="ru" href="/master/ru/">
  <link rel="alternate" hreflang="uk" href="/master/uk/">
  <link rel="alternate" hreflang="zh-CN" href="/master/zh-CN/">
  <link rel="alternate" hreflang="zh-TW" href="/master/zh-TW/">
  <link rel="alternate" hreflang="x-default" href="/"> 
  </head>
  <body role="document" id="top">
    <div class="topbar">
  <div role="navigation" aria-label="related navigation">
    <div class="sp-logo-container sp-not-mobileview sp-mobileview">
      <a class="sp-logo-link" data-auto-route="true" href="/">
        <img height="40px" id="site-logo" class="logo-big" alt="" src="https://www.spongepowered.org/assets/img/icons/spongie-mark.svg">
        <span id="sp-site-title">Sponge</span>
      </a>
      <div class="sp-logo-bg"></div>
      <div class="sp-logo-chevron"><i class="fa fa-fw fa-chevron-down"></i></div>
      <div class="sp-logo-menu sp-skip-handler">
        <ul class="sp-logo-dropdown" id="ddleft">
          <a href="https://www.spongepowered.org"><li><i class="fa-fw fa fa-home"></i>Homepage</li></a>
          <a href="https://forums.spongepowered.org"><li><i class="fa-fw fa fa-comments"></i>Forums</li></a>
          <a href="https://github.com/SpongePowered"><li><i class="fa-fw fa fa-code"></i>Code</li></a>
          <a class="sp-forums-home" href="https://docs.spongepowered.org"><li class="active"><i class="fa-fw fa fa-book"></i>Docs</li></a>
          <a href="https://jd.spongepowered.org"><li><i class="fa-fw fa fa-graduation-cap"></i>Javadocs</li></a>
          <a href="https://forums.spongepowered.org/c/plugins/plugin-releases"><li><i class="fa-fw fa fa-plug"></i>Plugins</li></a>
          <a href="https://www.spongepowered.org/downloads"><li><i class="fa-fw fa fa-download"></i>Downloads</li></a>
          <a href="https://www.spongepowered.org/chat"><li><i class="fa-fw fa fa-comment"></i>Chat</li></a>
        </ul>
      </div>
    </div>
    <div class="menu-right">
      <div><i class="fa fa-fw fa-globe"></i></div>
        <ul class="dropdown" id="ddlang">
          <li><a href="/master/da/" class="lang"><img src="//d1ztvzf22lmr1j.cloudfront.net/images/flags/da.png" alt="Flag for Danish"/></a></li>
          <li><a href="/master/de/" class="lang"><img src="//d1ztvzf22lmr1j.cloudfront.net/images/flags/de.png" alt="Flag for German"/></a></li>
          <li><a href="/master/en-GB/" class="lang"><img src="//d1ztvzf22lmr1j.cloudfront.net/images/flags/en-GB.png" alt="Flag for English, United Kingdom"/></a></li>
          <li><a href="/master/en-PT/" class="lang"><img src="//d1ztvzf22lmr1j.cloudfront.net/images/flags/en-PT.png" alt="Flag for Pirate English"/></a></li>
          <li><a href="/master/en/" class="lang"><img src="//d1ztvzf22lmr1j.cloudfront.net/images/flags/en.png" alt="Flag for English"/></a></li>
          <li><a href="/master/es-ES/" class="lang"><img src="//d1ztvzf22lmr1j.cloudfront.net/images/flags/es-ES.png" alt="Flag for Spanish"/></a></li>
          <li><a href="/master/fi/" class="lang"><img src="//d1ztvzf22lmr1j.cloudfront.net/images/flags/fi.png" alt="Flag for Finnish"/></a></li>
          <li><a href="/master/fr/" class="lang"><img src="//d1ztvzf22lmr1j.cloudfront.net/images/flags/fr.png" alt="Flag for French"/></a></li>
          <li><a href="/master/it/" class="lang"><img src="//d1ztvzf22lmr1j.cloudfront.net/images/flags/it.png" alt="Flag for Italian"/></a></li>
          <li><a href="/master/ja/" class="lang"><img src="//d1ztvzf22lmr1j.cloudfront.net/images/flags/ja.png" alt="Flag for Japanese"/></a></li>
          <li><a href="/master/ko/" class="lang"><img src="//d1ztvzf22lmr1j.cloudfront.net/images/flags/ko.png" alt="Flag for Korean"/></a></li>
          <li><a href="/master/lt/" class="lang"><img src="//d1ztvzf22lmr1j.cloudfront.net/images/flags/lt.png" alt="Flag for Lithuanian"/></a></li>
          <li><a href="/master/nb/" class="lang"><img src="//d1ztvzf22lmr1j.cloudfront.net/images/flags/nb.png" alt="Flag for Norwegian Bokmal"/></a></li>
          <li><a href="/master/nl/" class="lang"><img src="//d1ztvzf22lmr1j.cloudfront.net/images/flags/nl.png" alt="Flag for Dutch"/></a></li>
          <li><a href="/master/pl/" class="lang"><img src="//d1ztvzf22lmr1j.cloudfront.net/images/flags/pl.png" alt="Flag for Polish"/></a></li>
          <li><a href="/master/pt-BR/" class="lang"><img src="//d1ztvzf22lmr1j.cloudfront.net/images/flags/pt-BR.png" alt="Flag for Portuguese, Brazilian"/></a></li>
          <li><a href="/master/pt-PT/" class="lang"><img src="//d1ztvzf22lmr1j.cloudfront.net/images/flags/pt-PT.png" alt="Flag for Portuguese"/></a></li>
          <li><a href="/master/ru/" class="lang"><img src="//d1ztvzf22lmr1j.cloudfront.net/images/flags/ru.png" alt="Flag for Russian"/></a></li>
          <li><a href="/master/uk/" class="lang"><img src="//d1ztvzf22lmr1j.cloudfront.net/images/flags/uk.png" alt="Flag for Ukrainian"/></a></li>
          <li><a href="/master/zh-CN/" class="lang"><img src="//d1ztvzf22lmr1j.cloudfront.net/images/flags/zh-CN.png" alt="Flag for Chinese Simplified"/></a></li>
          <li><a href="/master/zh-TW/" class="lang"><img src="//d1ztvzf22lmr1j.cloudfront.net/images/flags/zh-TW.png" alt="Flag for Chinese Traditional"/></a></li>
        </ul>
    </div>
    <div class="menu-right">
      <div><i class="fa fa-fw fa-tag"></i><a>5.0.0</a></div>
        <ul class="dropdown" id="ddvers">
          <li><a href="/master/en/"><i class="fa fa-fw fa-tag"></i> latest</a></li>
          <li><a href="/4.1.0/en/"><i class="fa fa-fw fa-tag"></i> 4.1.0</a></li>
          <li><a href="/3.1.0/en/"><i class="fa fa-fw fa-tag"></i> 3.1.0</a></li>
        </ul>
    </div>
    <div class="menu-right">
      <div title="Toggle syntax highlighting between light and dark" class="lights">
        <i class="fa fa-fw fa-lightbulb-o"></i>
      </div>
    </div>
    <div>
      <ul class="controls">
        <li>|</li>
        
        <li><a href="templates.html" title="Next Page"><i class="fa fa-fw fa-chevron-right"></i></a></li>
        
        <li><a href="#top" title="To the top"><i class="fa fa-fw fa-chevron-up"></i></a></li>
        <li><a href="../../index.html" title="Home"><i class="fa fa-fw fa-home"></i></a></li>
        
        <li><a href="pagination.html" title="Previous Page"><i class="fa fa-fw fa-chevron-left"></i></a></li>
        
        <li>|</li>
        
          <li><a href="https://github.com/SpongePowered/SpongeDocs/blob/master/source/plugin/text/messagechannels.rst" title="Edit on GitHub"><i class="fa fa-fw fa-github"></i></a></li>
        
      </ul>
    </div>
    <h3>Navigation</h3>
  </div>
    </div>
    <div class="container">

      <div class="breadcrumbs">
        <ul>
        <li><a href="../../index.html">Sponge 5.0.0 dokumentation</a><i class="fa fa-fw fa-chevron-right"></i></li>
        <li><a href="../index.html" >Creating a Plugin</a><i class="fa fa-fw fa-chevron-right"></i></li>
        <li><a href="index.html" accesskey="U">Text</a><i class="fa fa-fw fa-chevron-right"></i></li>
        </ul>
      </div> 
    <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
      <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
    <form class="search" action="../../search.html" method="get">
      <div class="searchbox-inner">
        <input class="field" type="text" name="q" autocomplete="off" />
        <button class="submit" type="submit"><i class="fa fa-fw fa-search" aria-hidden="true"></i></button>
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
      </div>
    </form>
    <p class="searchtip" style="font-size: 90%"></p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script><h3><a href="../../index.html">Indholdsfortegnelse</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../server/index.html">Creating a Server</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../server/getting-started/index.html">Getting Started</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../server/getting-started/jre.html">Installing Java</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../server/getting-started/migrating.html">Migrating to Sponge</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../server/getting-started/implementations/index.html">Choosing an Implementation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../server/getting-started/implementations/spongeforge.html">Installing SpongeForge</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../server/getting-started/implementations/spongevanilla.html">Installing SpongeVanilla</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../server/getting-started/launch-script.html">Creating a Launch Script</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../server/getting-started/port-forward.html">Portvideresendelse</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../server/getting-started/bungeecord.html">Using Sponge with BungeeCord</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../server/getting-started/configuration/index.html">Configuring Sponge</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../server/getting-started/configuration/hocon.html">Introduktion til HOCON</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../server/getting-started/configuration/json.html">JSON Syntax</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../server/getting-started/configuration/sponge-conf.html">global.conf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../server/getting-started/configuration/server-properties.html">server.properties</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../server/management/index.html">Server Management</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../server/management/whitelist.html">Håndtering af whitelisten</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../server/management/bans.html">Håndtering Forbud</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../server/management/permissions.html">Managing Permissions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../server/management/plugins.html">Installing Plugins</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../server/management/exploit-patches.html">Exploit Patches</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../server/management/performance-tweaks.html">Performance Tweaks</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../server/spongineer/index.html">Becoming an Expert Spongineer</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../server/spongineer/commands.html">Kommandoere</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../server/spongineer/troubleshooting.html">Fejlfinding</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../server/spongineer/logs.html">Log Files</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../server/spongineer/debugging.html">Debugging</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../server/spongineer/bugreport.html">Reporting Bugs</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../preparing/index.html">Preparing for Development</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../preparing/jdk.html">Installing the JDK</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../preparing/ide.html">Installing an IDE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../preparing/text.html">Installing a Text Editor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../preparing/git.html">Installing Git</a></li>
</ul>
</li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Creating a Plugin</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../buildsystem.html">Build Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../workspace/index.html">Setting Up Your Workspace</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../workspace/idea.html">Setting Up IntelliJ IDEA</a></li>
<li class="toctree-l3"><a class="reference internal" href="../workspace/eclipse.html">Setting Up Eclipse</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../project/index.html">Setting Up Your Project</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../project/gradle.html">Setting Up Gradle</a></li>
<li class="toctree-l3"><a class="reference internal" href="../project/maven.html">Setting Up Maven</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../plugin-identifier.html">Plugin Identifiers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plugin-class.html">Main Plugin Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lifecycle.html">Plug-in Livscyklus</a></li>
<li class="toctree-l2"><a class="reference internal" href="../injection.html">Dependency Injection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practices.html">Best Practices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../optional/index.html">Optionals</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../optional/basic.html">Optionals Explained</a></li>
<li class="toctree-l3"><a class="reference internal" href="../optional/usage.html">Usage Examples</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../logging.html">Logging and Debugging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../commands/index.html">Commands</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../commands/creating.html">Building a Command</a></li>
<li class="toctree-l3"><a class="reference internal" href="../commands/arguments.html">Argument Parsing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../commands/flags.html">Command Flags</a></li>
<li class="toctree-l3"><a class="reference internal" href="../commands/childcommands.html">Child Commands</a></li>
<li class="toctree-l3"><a class="reference internal" href="../commands/service.html">The Command Manager</a></li>
<li class="toctree-l3"><a class="reference internal" href="../commands/commandcallable.html">Low-Level Command API</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../event/index.html">Events</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../event/listeners.html">Event Listeners</a></li>
<li class="toctree-l3"><a class="reference internal" href="../event/causes.html">Event Causes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../event/filters.html">Event Filters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../event/custom.html">Custom Events</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../assets.html">The Asset API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/index.html">Configuring Plugins</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../configuration/loaders.html">Configuration Loaders</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/nodes.html">Configuration Nodes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/serialization.html">Serializing Objects</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Text</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="text.html">Creating Text</a></li>
<li class="toctree-l3"><a class="reference internal" href="representations/index.html">Text Serializers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="representations/formatting-code-legacy.html">Formatting Code &amp; Legacy Format</a></li>
<li class="toctree-l4"><a class="reference internal" href="representations/xml.html">TextXML Format</a></li>
<li class="toctree-l4"><a class="reference internal" href="representations/json.html">JSON Format</a></li>
<li class="toctree-l4"><a class="reference internal" href="representations/configurate.html">Configuration Format</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pagination.html">The Pagination Service</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Message Channels</a></li>
<li class="toctree-l3"><a class="reference internal" href="templates.html">TextTemplates</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../data/index.html">The Data API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../data/keys.html">Using Keys</a></li>
<li class="toctree-l3"><a class="reference internal" href="../data/datamanipulators.html">Data Manipulators</a></li>
<li class="toctree-l3"><a class="reference internal" href="../data/transactions.html">Transactions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../data/serialization.html">Serializing Data</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../blocks/index.html">Blocks</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../blocks/concepts.html">Concepts</a></li>
<li class="toctree-l3"><a class="reference internal" href="../blocks/accessing.html">Accessing Blocks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../blocks/modifying.html">Modifying Blocks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../blocks/tileentities.html">Tile Entities</a></li>
<li class="toctree-l3"><a class="reference internal" href="../blocks/virtualblock.html">Virtual Block Changes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../entities/index.html">Entities</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../entities/spawning.html">Spawning an Entity</a></li>
<li class="toctree-l3"><a class="reference internal" href="../entities/modifying.html">Modifying an Entity</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../items/index.html">Items</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../items/usage.html">Basic Item Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../items/creating.html">Creating an ItemStack</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../trade-offers.html">Trade-Offers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../effects.html">Effects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scheduler.html">Scheduler</a></li>
<li class="toctree-l2"><a class="reference internal" href="../services.html">Services</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database.html">Databases</a></li>
<li class="toctree-l2"><a class="reference internal" href="../permissions.html">Permissions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bans.html">Bans</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bookview.html">Book Views</a></li>
<li class="toctree-l2"><a class="reference internal" href="../economy/index.html">Economy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../economy/basics.html">Basic Concepts</a></li>
<li class="toctree-l3"><a class="reference internal" href="../economy/using.html">Using the Economy API</a></li>
<li class="toctree-l3"><a class="reference internal" href="../economy/practices.html">Economy API Best Practices</a></li>
<li class="toctree-l3"><a class="reference internal" href="../economy/implementing.html">Implementing the Economy API</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../wgen/index.html">World Generation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../wgen/modifiers.html">WorldGeneratorModifiers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../wgen/customwgen.html">Modifying World Generation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../manager.html">Plugin Manager</a></li>
<li class="toctree-l2"><a class="reference internal" href="../game-profile-manager.html">Game Profile Manager</a></li>
<li class="toctree-l2"><a class="reference internal" href="../offline-userplayer-data.html">Offline Player Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../debugging.html">Plugin Debugging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tab-lists.html">Tab Lists</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plugin-meta.html">Plugin Metadata</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ray-tracing.html">Ray Tracing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials.html">Tutorials</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/index.html">Contributing to Sponge</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../contributing/guidelines.html">Contribution Guidelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../contributing/howtogit.html">How to Git(Hub)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../contributing/implementation/index.html">Developing Sponge</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../contributing/implementation/codestyle.html">Code Style</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../contributing/implementation/git-implementation.html">Git Workflow for API and Implementations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../contributing/implementation/pr.html">Submitting a Pull-Request</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../contributing/implementation/debugging.html">Debugging Sponge inden for IDE</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../contributing/implementation/mixins.html">Mixins</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../contributing/implementation/datamanipulator.html">Implementing DataManipulators</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../contributing/spongedocs.html">SpongeDocs Writing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../contributing/porting.html">Porting Sponge to Other Platforms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../contributing/versioning.html">Versioning System and Repository Branch Layout</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../about/index.html">Om Sponge projektet</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../about/introduction.html">Introduktion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../about/faq.html">Ofte stillede spørgsmål</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../about/structure.html">The Structure of the Sponge Project</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../about/future.html">Planer for fremtiden</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../about/license.html">Licens</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../about/posting.html">Forum Posting Guidelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../about/rules.html">Forum &amp; IRC Rules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../about/staff.html">Staff</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../about/glossary.html">Sponge Glossary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../about/assets.html">Art Assets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../about/history.html">The History of Sponge</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../downloads.html">Download</a></li>
</ul>

      </div>
    </div> 

        <div class="document">
            <div class="documentwrapper">
              <div class="bodywrapper">
                <div class="body" role="main">
                  
  <div class="section" id="message-channels">
<h1>Message Channels<a class="headerlink" href="#message-channels" title="Permalink til denne overskrift">¶</a></h1>
<p>In Sponge, every object that messages may be sent to implements the <a class="reference external" href="https://jd.spongepowered.org/5.0.0/org/spongepowered/api/text/channel/MessageReceiver.html">MessageReceiver</a> interface. A
<a class="reference external" href="https://jd.spongepowered.org/5.0.0/org/spongepowered/api/text/channel/MessageChannel.html">MessageChannel</a> is a device that may send messages to an arbitrary number of <code class="docutils literal"><span class="pre">MessageReceiver</span></code>s and even
perform actions like recipient-specific formatting of the message.</p>
<div class="section" id="selecting-message-recipients">
<h2>Selecting Message Recipients<a class="headerlink" href="#selecting-message-recipients" title="Permalink til denne overskrift">¶</a></h2>
<p>Within the <code class="docutils literal"><span class="pre">MessageChannel</span></code> interface there are constants and static methods that can be used to obtain or create
commonly used channels. There are also other classes and interfaces that can be used to create a <code class="docutils literal"><span class="pre">MessageChannel</span></code>,
such as <a class="reference external" href="https://jd.spongepowered.org/5.0.0/org/spongepowered/api/text/channel/AbstractMutableMessageChannel.html">AbstractMutableMessageChannel</a> and <a class="reference external" href="https://jd.spongepowered.org/5.0.0/org/spongepowered/api/text/channel/MutableMessageChannel.html">MutableMessageChannel</a>. A complete list of these can be
found at <a class="reference external" href="https://jd.spongepowered.org/5.0.0/org/spongepowered/api/text/channel/package-summary.html">org.spongepowered.api.text.channel</a> and its sub-packages.</p>
<div class="section" id="broadcasting">
<h3>Broadcasting<a class="headerlink" href="#broadcasting" title="Permalink til denne overskrift">¶</a></h3>
<p>The most common channel will be the broadcasting channel. It can be obtained either from the
<a class="reference external" href="https://jd.spongepowered.org/5.0.0/org/spongepowered/api/Server.html">Server</a> via the <a class="reference external" href="https://jd.spongepowered.org/5.0.0/org/spongepowered/api/Server.html#getBroadcastChannel--">Server#getBroadcastChannel()</a> method or from either the
<a class="reference external" href="https://jd.spongepowered.org/5.0.0/org/spongepowered/api/text/channel/MessageChannel.html#TO_PLAYERS">MessageChannel#TO_PLAYERS</a> or <a class="reference external" href="https://jd.spongepowered.org/5.0.0/org/spongepowered/api/text/channel/MessageChannel.html#TO_ALL">MessageChannel#TO_ALL</a> constant. The only difference is that
<code class="docutils literal"><span class="pre">TO_ALL</span></code> includes not only every player connected to the server but also the server <code class="docutils literal"><span class="pre">Console</span></code>.</p>
<p>The channel returned by <code class="docutils literal"><span class="pre">getBroadcastChannel()</span></code> will generally be the <code class="docutils literal"><span class="pre">MessageChannel.TO_ALL</span></code> channel, however a
different channel may be set using the <a class="reference external" href="https://jd.spongepowered.org/5.0.0/org/spongepowered/api/Server.html#setBroadcastChannel-org.spongepowered.api.text.channel.MessageChannel-">Server#setBroadcastChannel(MessageChannel)</a> method.</p>
</div>
<div class="section" id="sending-to-a-fixed-list-of-messagereceivers">
<h3>Sending to a Fixed List of MessageReceivers<a class="headerlink" href="#sending-to-a-fixed-list-of-messagereceivers" title="Permalink til denne overskrift">¶</a></h3>
<p>It is also possible to send a message not to all players connected, but to a number of hand-selected receivers. This
can be done by passing the list of the intended recipients to the <a class="reference external" href="https://jd.spongepowered.org/5.0.0/org/spongepowered/api/text/channel/MessageChannel.html#fixed-MessageReceiver...-">MessageChannel#fixed(MessageReceiver...)</a>
method. Unlike most other channels, the list of recipients will not be generated dynamically every time something is
sent through the channel but remains static for the rest of its existence. However, the references kept are <em>weak</em>.
This means that if for example a player disconnects and the corresponding <a class="reference external" href="https://jd.spongepowered.org/5.0.0/org/spongepowered/api/entity/living/player/Player.html">Player</a> object is removed by Java&#8217;s
<em>garbage collector</em>, that player will also vanish from the channels recipient list.</p>
</div>
<div class="section" id="permission-based-selection">
<h3>Permission-based Selection<a class="headerlink" href="#permission-based-selection" title="Permalink til denne overskrift">¶</a></h3>
<p>It is also possible to create a channel sending to all recipients that hold a specific permission. The channel is
obtained from the <a class="reference external" href="https://jd.spongepowered.org/5.0.0/org/spongepowered/api/text/channel/MessageChannel.html#permission-java.lang.String-">MessageChannel#permission(String)</a> method with the permission to check for as an argument.
When a message is then sent through this channel, it will obtain all subjects from the <a class="reference external" href="https://jd.spongepowered.org/5.0.0/org/spongepowered/api/service/permission/PermissionService.html">PermissionService</a>
that have the given permission.</p>
</div>
<div class="section" id="combining-channels">
<h3>Combining Channels<a class="headerlink" href="#combining-channels" title="Permalink til denne overskrift">¶</a></h3>
<p>It is also possible to combine multiple channels into one. This can be done by passing all channels into the
<a class="reference external" href="https://jd.spongepowered.org/5.0.0/org/spongepowered/api/text/channel/MessageChannel.html#combined-MessageChannel...-">MessageChannel#combined(MessageChannel...)</a> method. The resulting channel will relay messages to every
recipient that is targeted by at least one of the combined channels.</p>
</div>
</div>
<div class="section" id="sending-messages">
<h2>Sending Messages<a class="headerlink" href="#sending-messages" title="Permalink til denne overskrift">¶</a></h2>
<p>Once you have obtained a <code class="docutils literal"><span class="pre">MessageChannel</span></code> you can send a message through it via the
<a class="reference external" href="https://jd.spongepowered.org/5.0.0/org/spongepowered/api/text/channel/MessageChannel.html#send-java.lang.Object-org.spongepowered.api.text.Text-">MessageChannel#send(Object, Text)</a> method. This method is preferred over the
<a class="reference external" href="https://jd.spongepowered.org/5.0.0/org/spongepowered/api/text/channel/MessageChannel.html#send-org.spongepowered.api.text.Text-">MessageChannel#send(Text)</a> method, as the <code class="docutils literal"><span class="pre">Object</span></code> can be used for identification or for performing other
various actions. Alternatively, you can use a <a class="reference external" href="https://jd.spongepowered.org/5.0.0/org/spongepowered/api/text/chat/ChatType.html">ChatType</a> to specify where the message will be sent to. Using
the <a class="reference external" href="https://jd.spongepowered.org/5.0.0/org/spongepowered/api/text/channel/MessageChannel.html#send-java.lang.Object-org.spongepowered.api.text.Text-org.spongepowered.api.text.chat.ChatType-">MessageChannel#send(Object, Text, ChatType)</a> method will allow you to accomplish this. The channel will
then transform the message for every recipient and send the transformed message.</p>
<div class="section" id="extended-application-chat-channels">
<h3>Extended Application: Chat Channels<a class="headerlink" href="#extended-application-chat-channels" title="Permalink til denne overskrift">¶</a></h3>
<p>Message channels have a very useful application as they can be used to establish chat channels. For example, you could
establish a message channel for every chat channel you wish to have. Then, when a <code class="docutils literal"><span class="pre">MessageReceiver</span></code> joins a channel,
such as with <code class="docutils literal"><span class="pre">/join</span> <span class="pre">&lt;channel</span> <span class="pre">name&gt;</span></code>, simply set the <code class="docutils literal"><span class="pre">MessageReceiver</span></code>&#8216;s <code class="docutils literal"><span class="pre">MessageChannel</span></code> to the appropriate
channel using <a class="reference external" href="https://jd.spongepowered.org/5.0.0/org/spongepowered/api/text/channel/MessageReceiver.html#setMessageChannel-org.spongepowered.api.text.channel.MessageChannel-">MessageReceiver#setMessageChannel(MessageChannel)</a>. This will cause every message sent <em>from</em>
the <code class="docutils literal"><span class="pre">MessageReceiver</span></code> to be passed to the given <code class="docutils literal"><span class="pre">MessageChannel</span></code> instead of the default one. Alternatively,
you could listen to <a class="reference external" href="https://jd.spongepowered.org/5.0.0/org/spongepowered/api/event/message/MessageChannelEvent.html">MessageChannelEvent</a>, and set the appropriate <code class="docutils literal"><span class="pre">MessageChannel</span></code> using
<a class="reference external" href="https://jd.spongepowered.org/5.0.0/org/spongepowered/api/event/message/MessageChannelEvent.html#setChannel-org.spongepowered.api.text.channel.MessageChannel-">MessageChannelEvent#setChannel(MessageChannel)</a>. Passing <code class="docutils literal"><span class="pre">null</span></code> to that method will unset any custom
channel, causing the message to be sent to the original MessageChannel instead.</p>
</div>
</div>
<div class="section" id="transforming-messages">
<h2>Transforming Messages<a class="headerlink" href="#transforming-messages" title="Permalink til denne overskrift">¶</a></h2>
<p>You can apply a filter to all <code class="docutils literal"><span class="pre">Text</span></code>s that pass through a <code class="docutils literal"><span class="pre">MessageChannel</span></code> to change the message however you
like. This is possible by extending <code class="docutils literal"><span class="pre">MessageChannel</span></code> and overriding the
<a class="reference external" href="https://jd.spongepowered.org/5.0.0/org/spongepowered/api/text/channel/MessageChannel.html#transformMessage-java.lang.Object-org.spongepowered.api.text.channel.MessageReceiver-org.spongepowered.api.text.Text-org.spongepowered.api.text.chat.ChatType-">MessageChannel#transformMessage(Object, MessageReceiver, Text, ChatType)</a> method as demonstrated below.</p>
<p><strong>Example: Transforming Messages</strong></p>
<p>The following code excerpt defines an <code class="docutils literal"><span class="pre">AdminMessageChannel</span></code> class which overrides the default <code class="docutils literal"><span class="pre">transformMessage</span></code>
method. The new <code class="docutils literal"><span class="pre">transformMessage</span></code> method will take the original message and append a red <code class="docutils literal"><span class="pre">[Admin]</span></code> tag to the
front of the message.</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">java.util.Collection</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Collections</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Optional</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.spongepowered.api.text.Text</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.spongepowered.api.text.channel.MessageChannel</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.spongepowered.api.text.channel.MessageReceiver</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.spongepowered.api.text.format.TextColors</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">AdminMessageChannel</span> <span class="kd">implements</span> <span class="n">MessageChannel</span> <span class="o">{</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">Optional</span><span class="o">&lt;</span><span class="n">Text</span><span class="o">&gt;</span> <span class="nf">transformMessage</span><span class="o">(</span><span class="n">Object</span> <span class="n">sender</span><span class="o">,</span> <span class="n">MessageReceiver</span> <span class="n">recipient</span><span class="o">,</span>
                                                                <span class="n">Text</span> <span class="n">original</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Text</span> <span class="n">text</span> <span class="o">=</span> <span class="n">original</span><span class="o">;</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">Text</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="n">TextColors</span><span class="o">.</span><span class="na">RED</span><span class="o">,</span> <span class="s">&quot;[Admin]&quot;</span><span class="o">,</span> <span class="n">TextColors</span><span class="o">.</span><span class="na">RESET</span><span class="o">,</span> <span class="n">text</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">Optional</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="n">text</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">Collection</span><span class="o">&lt;</span><span class="n">MessageReceiver</span><span class="o">&gt;</span> <span class="nf">getMembers</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">Collections</span><span class="o">.</span><span class="na">emptyList</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<p>Note that we do not wish to define any additional recipients, so we return an empty collection in the
<a class="reference external" href="https://jd.spongepowered.org/5.0.0/org/spongepowered/api/text/channel/MessageChannel.html#getMembers--">MessageChannel#getMembers()</a> method.</p>
<p>Thanks to the capabilities of combined <code class="docutils literal"><span class="pre">MessageChannel</span></code>s, we can combine our newly created <code class="docutils literal"><span class="pre">AdminMessageChannel</span></code>
with any other <code class="docutils literal"><span class="pre">MessageChannel</span></code>. Now if a player joins with the <code class="docutils literal"><span class="pre">myplugin.admin</span></code> permission, we will obtain the
<code class="docutils literal"><span class="pre">MessageChannel</span></code> his messages are sent to, combine it with an <code class="docutils literal"><span class="pre">AdminMessageChannel</span></code> and set the combined channel
back onto the player. That way all his messages are sent to everyone specified in the original channel, but due to the
addition of the <code class="docutils literal"><span class="pre">AdminMessageChannel</span></code>, a red <code class="docutils literal"><span class="pre">[Admin]</span></code> tag will be prefixed.</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">org.spongepowered.api.entity.living.player.Player</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.spongepowered.api.event.Listener</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.spongepowered.api.event.network.ClientConnectionEvent</span><span class="o">;</span>

<span class="kd">private</span> <span class="n">AdminMessageChannel</span> <span class="n">adminChannel</span> <span class="o">=</span> <span class="k">new</span> <span class="n">AdminMessageChannel</span><span class="o">();</span>

<span class="nd">@Listener</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">onClientConnectionJoin</span><span class="o">(</span><span class="n">ClientConnectionEvent</span><span class="o">.</span><span class="na">Join</span> <span class="n">event</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">Player</span> <span class="n">player</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="na">getTargetEntity</span><span class="o">();</span>
    <span class="k">if</span><span class="o">(</span><span class="n">player</span><span class="o">.</span><span class="na">hasPermission</span><span class="o">(</span><span class="s">&quot;myplugin.admin&quot;</span><span class="o">))</span> <span class="o">{</span>
        <span class="n">MessageChannel</span> <span class="n">originalChannel</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="na">getOriginalChannel</span><span class="o">();</span>
        <span class="n">MessageChannel</span> <span class="n">newChannel</span> <span class="o">=</span> <span class="n">MessageChannel</span><span class="o">.</span><span class="na">combined</span><span class="o">(</span><span class="n">originalChannel</span><span class="o">,</span>
            <span class="n">adminChannel</span><span class="o">);</span>
        <span class="n">player</span><span class="o">.</span><span class="na">setMessageChannel</span><span class="o">(</span><span class="n">newChannel</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<p>Note that this will prefix <cite>all</cite> messages pertaining to a player. This includes death messages, leave messages, etc. If
you only want to prefix all <cite>chat</cite> messages, you would need to listen to <a class="reference external" href="https://jd.spongepowered.org/5.0.0/org/spongepowered/api/event/message/MessageChannelEvent.Chat.html">MessageChannelEvent.Chat</a> and set
the channel onto the event rather than the player. This would be done using <code class="docutils literal"><span class="pre">event.setChannel(newChannel)</span></code> onto the
<code class="docutils literal"><span class="pre">MessageChannelEvent.Chat</span></code> event. To get the player from the event to check for permissions, you would need to get a
<code class="docutils literal"><span class="pre">Player</span></code> from the <code class="docutils literal"><span class="pre">Cause</span></code> of the event. This is demonstrated below:</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="n">Optional</span><span class="o">&lt;</span><span class="n">Player</span><span class="o">&gt;</span> <span class="n">playerOptional</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="na">getCause</span><span class="o">().&lt;</span><span class="n">Player</span><span class="o">&gt;</span><span class="n">first</span><span class="o">(</span><span class="n">Player</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</pre></div>
</div>
<p>More on causes can be found on the <a class="reference internal" href="../event/causes.html"><span class="doc">causes page</span></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Bemærk</p>
<p class="last">When combining multiple <code class="docutils literal"><span class="pre">MessageChannel</span></code>s defining different message transformations, the <code class="docutils literal"><span class="pre">Text</span></code> will be
transformed in the order that the <code class="docutils literal"><span class="pre">MessageChannel</span></code>s are passed in to the
<code class="docutils literal"><span class="pre">MessageChannel#combined(MessageChannel...</span> <span class="pre">channels)</span></code> method. Note that any transformations resulting in an
empty <code class="docutils literal"><span class="pre">Optional</span></code> will be ignored unless performed by the last channel in the chain.</p>
</div>
</div>
<div class="section" id="mutable-message-channels">
<h2>Mutable Message Channels<a class="headerlink" href="#mutable-message-channels" title="Permalink til denne overskrift">¶</a></h2>
<p>A <a class="reference external" href="https://jd.spongepowered.org/5.0.0/org/spongepowered/api/text/channel/MutableMessageChannel.html">MutableMessageChannel</a> contains methods for changing who may receive the messages sent through our channel.
As such, we must implement methods for performing actions that modify our members. To do this, we simply will create a
class named <code class="docutils literal"><span class="pre">MutableAdminMessageChannel</span></code> that will implement a <code class="docutils literal"><span class="pre">MutableMessageChannel</span></code>.</p>
<div class="highlight-java"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">java.util.Set</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.WeakHashMap</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.spongepowered.api.text.channel.MutableMessageChannel</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MutableAdminMessageChannel</span> <span class="kd">implements</span> <span class="n">MutableMessageChannel</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="n">Set</span><span class="o">&lt;</span><span class="n">MessageReceiver</span><span class="o">&gt;</span> <span class="n">members</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">MutableAdminMessageChannel</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">(</span><span class="n">Collections</span><span class="o">.</span><span class="na">emptySet</span><span class="o">());</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nf">MutableAdminMessageChannel</span><span class="o">(</span><span class="n">Collection</span><span class="o">&lt;</span><span class="n">MessageReceiver</span><span class="o">&gt;</span> <span class="n">members</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">members</span> <span class="o">=</span> <span class="n">Collections</span><span class="o">.</span><span class="na">newSetFromMap</span><span class="o">(</span><span class="k">new</span> <span class="n">WeakHashMap</span><span class="o">&lt;&gt;());</span>
        <span class="k">this</span><span class="o">.</span><span class="na">members</span><span class="o">.</span><span class="na">addAll</span><span class="o">(</span><span class="n">members</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">Collection</span><span class="o">&lt;</span><span class="n">MessageReceiver</span><span class="o">&gt;</span> <span class="nf">getMembers</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">Collections</span><span class="o">.</span><span class="na">unmodifiableSet</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">members</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">addMember</span><span class="o">(</span><span class="n">MessageReceiver</span> <span class="n">member</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">members</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">member</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">removeMember</span><span class="o">(</span><span class="n">MessageReceiver</span> <span class="n">member</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">members</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="n">member</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">clearMembers</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">members</span><span class="o">.</span><span class="na">clear</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">Optional</span><span class="o">&lt;</span><span class="n">Text</span><span class="o">&gt;</span> <span class="nf">transformMessage</span><span class="o">(</span><span class="n">Object</span> <span class="n">sender</span><span class="o">,</span> <span class="n">MessageReceiver</span> <span class="n">recipient</span><span class="o">,</span>
                                                                <span class="n">Text</span> <span class="n">original</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Text</span> <span class="n">text</span> <span class="o">=</span> <span class="n">original</span><span class="o">;</span>
        <span class="k">if</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">members</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="n">recipient</span><span class="o">))</span> <span class="o">{</span>
            <span class="n">text</span> <span class="o">=</span> <span class="n">Text</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="n">TextColors</span><span class="o">.</span><span class="na">RED</span><span class="o">,</span> <span class="s">&quot;[Admin]&quot;</span><span class="o">,</span> <span class="n">TextColors</span><span class="o">.</span><span class="na">RESET</span><span class="o">,</span> <span class="n">text</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">Optional</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="n">text</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<p>The main difference between our <code class="docutils literal"><span class="pre">AdminMessageChannel</span></code> and our new <code class="docutils literal"><span class="pre">MutableAdminMessageChannel</span></code> is that we check if
the recipient is in the member list before transforming the message. If it is, then we may alter the message that is
sent, appending the red <code class="docutils literal"><span class="pre">[Admin]</span></code> prefix. In our <code class="docutils literal"><span class="pre">getMembers()</span></code> method we return an immutable set, so that the set
can only be modified by the appropriate methods in our <code class="docutils literal"><span class="pre">MutableAdminMessageChannel</span></code>.</p>
<p>Note that an abstract implementation for <code class="docutils literal"><span class="pre">MutableMessageChannel</span></code>s exists in the Sponge API as
<code class="docutils literal"><span class="pre">AbstractMutableMessageChannel</span></code>. Also note that our members do not persist. If a player were to leave the server,
they would be removed from the set.</p>
<div class="section" id="modifying-the-members">
<h3>Modifying the Members<a class="headerlink" href="#modifying-the-members" title="Permalink til denne overskrift">¶</a></h3>
<p>To make full use of our <code class="docutils literal"><span class="pre">MutableAdminMessageChannel</span></code>, we need to be able to add and remove members from the channel.
To do this, we can simply call our <a class="reference external" href="https://jd.spongepowered.org/5.0.0/org/spongepowered/api/text/channel/MutableMessageChannel.html#addMember-org.spongepowered.api.text.channel.MessageReceiver-">MutableMessageChannel#addMember(MessageReceiver)</a>
and <a class="reference external" href="https://jd.spongepowered.org/5.0.0/org/spongepowered/api/text/channel/MutableMessageChannel.html#removeMember-org.spongepowered.api.text.channel.MessageReceiver-">MutableMessageChannel#removeMember(MessageReceiver)</a> methods we implemented previously whenever we need
to add or remove a member from the member set.</p>
</div>
</div>
</div>


                </div>
              </div>
            </div>
          <div class="clearer"></div>
        </div>
        <div class="footer" role="contentinfo">
              &copy; Copyright 2014-2016, Sponge Contributors.
            Bygget med <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.1.
        </div>
    </div>
  </body>
</html>